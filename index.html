<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Mobile Promo Selector</title>
<style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fa;
      color: #333;
      margin: 0;
      padding: 2em;
    }

    h1 {
      text-align: center;
      color: #0056b3;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 2em;
    }

    .question {
      margin-bottom: 2em;
    }

    .question p {
      font-size: 1.2em;
      margin-bottom: 1em;
    }

    .hidden {
      display: none;
    }

    .result {
      background-color: #e6e8f4;
      padding: 1em;
      margin-top: 1em;
      border-left: 6px solid #0b3ed9;
      border-radius: 4px;
      font-weight: bold;
    }

    .disclaimer {
      font-weight: normal;
      font-size: 0.95em;
      margin-top: 0.75em;
      color: #555;
    }

    button {
      display: block;
      width: 100%;
      padding: 0.75em;
      margin-bottom: 0.75em;
      font-size: 1em;
      border: none;
      border-radius: 4px;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
<div class="container">
<h1>Mobile Promo Flow Tool</h1>
<div class="question" id="step1">
<p>Is the customer a new internet subscriber or under 90 days?</p>
<button onclick="isUnder90Days = true; goToStep('internetSpeedCheck')">Yes</button>
<button onclick="isUnder90Days = false; goToStep('over90')">No</button>
</div>
<div class="question hidden" id="internetSpeedCheck">
<p>Now, does the customer have 500 mbps or higher?</p>
<button onclick="goToStep('under90highspeed')">Yes</button>
<button onclick="goToStep('over90')">No</button>
</div>
<div class="question hidden" id="under90highspeed">
<p>How many mobile lines is the customer adding?</p>
<button onclick="showResult('1 line free (After 12 months: $45/mo) - Promo: HEYITSFREE')">1 Line</button>
<button onclick="showResult('$30 for 2 lines ($15/line) (After 12 months: $60/mo) - Promo: HEYITSFREE')">2 Lines</button>
<button onclick="showResult('$60 for 3 lines ($20/line) (After 12 months: $90/mo) - Promo: HEYITSFREE')">3 Lines</button>
<button onclick="showResult('$90 for 4 lines ($22.50/line) (After 12 months: $120/mo) - Promo: HEYITSFREE')">4 Lines</button>
<button onclick="showResult('$115 for 5 lines ($23/line) (After 12 months: $125/mo) - Promo: HEYITSFREE')">5 Lines</button>
<button onclick="showResult('$138 for 6 lines ($23/line) (After 12 months: $150/mo) - Promo: HEYITSFREE')">6 Lines</button>
<button onclick="showResult('$161 for 7 lines ($23/line) (After 12 months: $175/mo) - Promo: HEYITSFREE')">7 Lines</button>
<button onclick="showResult('$184 for 8 lines ($23/line) (After 12 months: $200/mo) - Promo: HEYITSFREE')">8 Lines</button>
<button onclick="showResult('$207 for 9 lines ($23/line) (After 12 months: $225/mo) - Promo: HEYITSFREE')">9 Lines</button>
<button onclick="showResult('$230 for 10 lines ($23/line) (After 12 months: $250/mo) - Promo: HEYITSFREE')">10 Lines</button>
</div>
<div class="question hidden" id="over90">
<p>Is there a $10 Deal active?</p>
<button onclick="goToStep('boostYes')">Yes</button>
<button onclick="goToStep('boostNo')">No</button>
</div>
<div class="question hidden" id="boostYes">
<p>How many mobile lines?</p>
<button onclick="showResult('$10 for 1 line (After 12 months: $45/mo) - Promo: ONEFOR10')">1 Line</button>
<button onclick="showResult('$36.67 for 2 lines (After 12 months: $60/mo) - Promo: ONEFOR10')">2 Lines</button>
<button onclick="showResult('$66.67 for 3 lines (After 12 months: $90/mo) - Promo: ONEFOR10')">3 Lines</button>
<button onclick="showResult('$96.67 for 4 lines (After 12 months: $120/mo) - Promo: ONEFOR10')">4 Lines</button>
<button onclick="showResult('$110 for 5 lines (After 12 months: $125/mo) - Promo: ONEFOR10')">5 Lines</button>
<button onclick="showResult('$135 for 6 lines (After 12 months: $150/mo) - Promo: ONEFOR10')">6 Lines</button>
<button onclick="showResult('$160 for 7 lines (After 12 months: $175/mo) - Promo: ONEFOR10')">7 Lines</button>
<button onclick="showResult('$185 for 8 lines (After 12 months: $200/mo) - Promo: ONEFOR10')">8 Lines</button>
<button onclick="showResult('$210 for 9 lines (After 12 months: $225/mo) - Promo: ONEFOR10')">9 Lines</button>
<button onclick="showResult('$235 for 10 lines (After 12 months: $250/mo) - Promo: ONEFOR10')">10 Lines</button>
</div>
<div class="question hidden" id="boostNo">
<p>How many mobile lines?</p>
<button onclick="showResult('$25 for 1 line (After 12 months: $45/mo) - Promo: ONEFOR25')">1 Line</button>
<button onclick="showResult('$45 for 2 lines (After 12 months: $60/mo) - Promo: BOGO')">2 Lines</button>
<button onclick="showResult('$75 for 3 lines (After 12 months: $90/mo) - Promo: BOGO + Add a Line')">3 Lines</button>
<button onclick="showResult('$100 for 4 lines (After 12 months: $120/mo) - Promo: HAPPYFAM')">4 Lines</button>
<button onclick="showResult('$125 for 5 lines - Promo: No Promo code needed')">5 Lines</button>
<button onclick="showResult('$150 for 6 lines - Promo: No Promo code needed')">6 Lines</button>
<button onclick="showResult('$175 for 7 lines - Promo: No Promo code needed')">7 Lines</button>
<button onclick="showResult('$200 for 8 lines - Promo: No Promo code needed')">8 Lines</button>
<button onclick="showResult('$225 for 9 lines - Promo: No Promo code needed')">9 Lines</button>
<button onclick="showResult('$250 for 10 lines - Promo: No Promo code needed')">10 Lines</button>
</div>
<div class="result hidden" id="result">
<span id="offerText"></span>
<div style="text-align:center; margin-top:1em;"></div><div class="disclaimer">
<p>First bill will not include the promotion and the customers will be responsible for the full monthly device payment.</p>
<p>Trade-ins processed via Asurion; credits begin within 2 bill cycles.</p>
<p>Port-in or Financing a Device is required to qualify for promotional pricing.</p>
<p>Prices before taxes and fees.</p>
</div>
<div style="text-align:center; margin-top:1em;">
<button onclick="printResult()" style="background-color:#28a745;">Print Offer as Receipt</button>
<button onclick="printFullPage()" style="background-color:#6c757d; margin-top: 0.5em;">Print Full Page Summary</button>
<a href="https://braydenhanning.github.io/receiptinstructions/" target="_blank">
<button style="background-color:#ffc107; color:#000; font-size: 0.9em; width: 100%;">
    Help, my receipt is 50 miles long!
  </button>
</a>
</div>
</div><div class="question hidden" id="devicePrompt">
<p>Would the customer like to add a mobile device?</p>
<button onclick="handleDeviceSelection('no')">No</button>
<button onclick="goToStep('modelSelect')">Yes</button>
</div><div class="question hidden" id="brandSelect">
<p>Which device brand is the customer interested in?</p>
<button onclick="goToStep('appleModels')">Apple</button>
<button onclick="goToStep('samsungModels')">Samsung</button>
<button onclick="goToStep('motorolaModels')">Motorola</button>
</div>
</div>
<div class="question hidden" id="modelSelect">
<p>Select Mobile Devices (check all that apply and choose quantity):</p>
<form id="deviceForm">
<!-- Apple -->
<!-- Phones -->
<label><input name="device" type="checkbox" value="iPhone 15|6.37|Up to $500 off with trade-in"/> iPhone 15</label>
<select name="qty_iPhone 15"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="iPhone 15 Plus|9.14|Up to $500 off with trade-in"/> iPhone 15 Plus</label>
<select name="qty_iPhone 15 Plus"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="iPhone 16e|0|$0/mo with $100+ trade-in"/> iPhone 16e</label>
<select name="qty_iPhone 16e"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="iPhone 16|0|Free with $225+ trade-in"/> iPhone 16</label>
<select name="qty_iPhone 16"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="Galaxy S25|0|$0/mo with trade-in"/> Galaxy S25</label>
<select name="qty_Galaxy S25"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="Galaxy A54|0|$0/mo with trade-in"/> Galaxy A54</label>
<select name="qty_Galaxy A54"><option>1</option><option>2</option><option>3</option></select><br/>
<label><input name="device" type="checkbox" value="Moto Razr 2025|15|$15/mo after $200 off"/> Moto Razr 2025</label>
<select name="qty_Moto Razr 2025"><option>1</option><option>2</option><option>3</option></select><br/>
<!-- Add-On Section -->
<hr style="margin: 1.5em 0;"/>
<strong style="font-size: 1.1em;">Choose an Add-On Device</strong><br/><br/>
<label><input name="device" type="checkbox" value="iPad (A16)|8.30|$200 off"/> iPad (A16)</label>
<select name="qty_iPad (A16)"><option>1</option><option>2</option><option>3</option></select><br/>
</form>
<button onclick="processMultipleDevices()">Continue</button>
</div><script>
    let isUnder90Days = false;
let serviceTotal = 0;
let deviceTotal = 0;
let fullSummary = "";

function goToStep(step) {
  document.querySelectorAll('.question').forEach(q => q.classList.add('hidden'));
  const el = document.getElementById(step);
  if (el) el.classList.remove('hidden');
  if (step !== 'result') document.getElementById('result').classList.add('hidden');
}

function showResult(text) {
  const beforeAfter = text.split('After')[0];
  const match = beforeAfter.match(/\$([\d]+)/);
  const serviceLines = match ? parseInt(match[1]) : 0;

  const form = document.getElementById("deviceForm");
  const checkboxes = form ? form.querySelectorAll("input[type=checkbox]:checked") : [];
  let hasOnlyIpad = false;
  let hasIpad = false;
  let hasPhone = false;

 checkboxes.forEach(cb => {
  const [label, costStr, promo] = cb.value.split("|");
  const qty = parseInt(form.querySelector(`select[name='qty_${label}']`).value);
  let monthlyCost = parseFloat(costStr);
  const isIpad = label.toLowerCase().includes("ipad");

  if (isIpad) {
    // Display the device's monthly cost
    monthlyCost = parseFloat(costStr);

    // Adjust service total: $45 for single iPad line, $25 if there's another mobile line
    const serviceCost = (getMobileLineCount() > 1) ? 25 : 45;
    serviceTotal = getMobileLineCount() * serviceCost;
  }

  const totalCost = qty * monthlyCost;
  totalDeviceCost += totalCost;

  // Only show device cost in summary, not service line pricing
  deviceSummary += `\n${qty}x ${label} - $${monthlyCost}/mo each (${promo})`;
});

  // If it's only iPad(s), adjust the offer text and strip promo
  if ((serviceLines === 1 && hasIpad && !hasPhone) || (hasIpad && !hasPhone)) {
    fullSummary = `Recommended Offer: $${serviceLines * 45} for ${serviceLines} line${serviceLines > 1 ? 's' : ''} – Promo: No promo code available`;
    serviceTotal = serviceLines * 45;
  } else {
    fullSummary = "Recommended Offer: " + text;
    serviceTotal = match ? parseInt(match[1]) : 0;
  }

  goToStep('devicePrompt');
}
function handleDeviceSelection(choice) {
  if (choice === 'no') {
    deviceTotal = 0;
    fullSummary += "\nDevice Promo: No device added";
    displayFinalResult(0);
  } else {
    goToStep('modelSelect');
  }
}

function setDevicePromo(text) {
  fullSummary += "\nDevice Promo: " + text;
}

function displayFinalResult(deviceAmount) {
  deviceTotal = deviceAmount;
  const total = serviceTotal + deviceTotal;
  fullSummary += "\nEstimated Monthly Total: $" + total;
  document.getElementById('offerText').innerText = fullSummary;
  goToStep('result');
}
</script><div class="question hidden" id="appleModels"><p>Select an Apple Device:</p>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('iPhone 15 - Up to $500 off with trade-in'); displayFinalResult(0)">iPhone 15</button>
</div>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('iPhone 15 Plus - Up to $500 off with trade-in'); displayFinalResult(0)">iPhone 15 Plus</button>
</div>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('iPhone 16e - $0/mo with $100+ trade-in'); displayFinalResult(0)">iPhone 16e</button>
</div>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('iPhone 16 - Free with $225+ trade-in'); displayFinalResult(0)">iPhone 16</button>
</div>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('iPad (A16) - $10/mo after $200 off'); displayFinalResult(10)">iPad (A16)</button>
</div>
</div><div class="question hidden" id="samsungModels"><p>Select a Samsung Device:</p>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('Galaxy S23 - $5/mo with trade-in'); displayFinalResult(5)">Galaxy S23</button>
</div>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('Galaxy A54 - $0/mo with trade-in'); displayFinalResult(0)">Galaxy A54</button>
</div>
</div><div class="question hidden" id="motorolaModels"><p>Select a Motorola Device:</p>
<div style="text-align:center; margin-bottom:1.5em;">
<button onclick="setDevicePromo('Moto Razr 2025 - $15/mo after $200 off'); displayFinalResult(15)">Moto Razr 2025</button>
</div>
</div>
<script>
function printResult() {
  const offerText = document.getElementById('offerText').innerText;
  const legalFinePrint = isUnder90Days
    ? '<p style="margin-top:2em; font-size:14px; color:#555;">*This offer is only valid within 90 days of internet service activation.</p>'
    : '';

  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head>
        <title>Print Offer</title>
        <style>
  @media print {
    @page {
      size: 58mm auto;
      margin: 0;
    }

    body {
      width: 58mm;
      margin: 0;
      padding: 0;
      font-family: monospace;
      font-size: 10pt;
      line-height: 1.4;
    }

    .summary {
      white-space: pre-wrap;
      word-break: break-word;
      margin: 0;
      padding: 0;
    }
  }
</style>
      </head>
      <body>
        <pre class="summary">${offerText}</pre>
        ${legalFinePrint}
        <p style="margin-top:1em; font-size:14px; color:#555;">*Promotional credits may take up to 2 billing cycles to appear on the account.</p>
        <p style="font-size:14px; color:#555;">*Port-in or device financing may be required for promotional eligibility.</p>
        <p style="font-size:14px; color:#555;">*Prices before taxes and fees.</p>
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.focus();
  setTimeout(() => {
    printWindow.print();
  }, 500);
}

function printFullPage() {
  const offerText = document.getElementById('offerText').innerText;
  const legalFinePrint = isUnder90Days
    ? '<p style="margin-top:2em; font-size:14px; color:#555;">*This offer is only valid within 90 days of internet service activation.</p>'
    : '';

  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
    <head>
      <title>Print Offer</title>
      <style>
        @media print {
          .no-print { display: none; }
        }
        body {
          font-family: sans-serif;
          padding: 40px;
          font-size: 18px;
          line-height: 1.6;
        }
        h2 {
          color: #2760f0;
          text-align: center;
        }
        .summary {
          white-space: pre-wrap;
          background: #e6f4ea;
          padding: 20px;
          border-left: 6px solid #007bff;
          border-radius: 8px;
          font-weight: bold;
          margin-top: 1em;
        }
        .logo {
          display: block;
          max-width: 200px;
          margin: 0 auto;
        }
      </style>
    </head>
    <body>
      <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/8/83/Optimum_logo.png" alt="Optimum Logo" />
      <h2>Mobile Promo Summary</h2>
      <div class="summary">${offerText}</div>
      ${legalFinePrint}
      <p style="margin-top:1em; font-size:14px; color:#555;">*Promotional credits may take up to 2 billing cycles to appear on the account.</p>
      <p style="font-size:14px; color:#555;">*Port-in or device financing may be required for promotional eligibility.</p>
<p style="font-size:14px; color:#555;">*Prices before taxes and fees.</p>
    </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.focus();
  setTimeout(() => {
    printWindow.print();
  }, 500); // 0.5 second delay
}

// existing functions like goToStep, showResult, etc.

function processMultipleDevices() {
  const form = document.getElementById("deviceForm");
  const checkboxes = form.querySelectorAll("input[type=checkbox]:checked");
  let deviceSummary = "";
  let totalDeviceCost = 0;
  let totalDevices = 0;
  let ipadQty = 0;
  let nonIpadDevices = 0;

serviceTotal = 0;

checkboxes.forEach(cb => {
  const [label, costStr, promo] = cb.value.split("|");
  const qty = parseInt(form.querySelector(`select[name='qty_${label}']`).value);
  const monthlyCost = parseFloat(costStr);

  const isIpad = label.includes("iPad");

  // Accumulate iPad service pricing
  if (isIpad) {
    const serviceCost = (nonIpadDevices > 0) ? 25 : 45;
    serviceTotal += qty * serviceCost;
  }

  const totalCost = qty * monthlyCost;
  totalDeviceCost += totalCost;

  const lineLabel = isIpad ? `${label}` : label;
  deviceSummary += `\n${qty}x ${lineLabel} - $${monthlyCost}/mo each (${promo})`;
});

  // Now loop again for summary (after determining if iPad should be $25 or $45)
  checkboxes.forEach(cb => {
    const [label, costStr, promo] = cb.value.split("|");
    const qty = parseInt(form.querySelector(`select[name='qty_${label}']`).value);
    let monthlyCost = parseFloat(costStr);

   if (label.includes("iPad")) {
  // Always use the device's base price for display
  monthlyCost = parseFloat(costStr); // e.g., $8.30
  const serviceCost = (getMobileLineCount() > 1) ? 25 : 45;
}

    const totalCost = qty * monthlyCost;
    totalDeviceCost += totalCost;
 const lineLabel = label.includes("iPad") ? `${label} (Service Line)` : label;
deviceSummary += `\n${qty}x ${label} - $${monthlyCost}/mo each (${promo})`;
  });

  if (totalDevices > 0 && totalDevices > getMobileLineCount()) {
    alert(`You selected ${totalDevices} device(s), but only ${getMobileLineCount()} mobile line(s). Each device must have a line.`);
    return;
  }

  if (totalDevices > 5) {
    const proceed = confirm("Financing is available for up to 5 devices every 90 days. For purchases exceeding this limit, the Pay In Full option remains available.\n\nDo you wish to continue?");
    if (!proceed) return;
  }

  fullSummary += "\nDevice Promo(s):" + deviceSummary;
  displayFinalResult(totalDeviceCost);
}

function getMobileLineCount() {
  if (!fullSummary.includes("line")) return 0;
  const match = fullSummary.match(/(\d+)\s+line/);
  return match ? parseInt(match[1]) : 0;
}

window.onload = function () {
  const form = document.getElementById("deviceForm");
  if (form) {
    const checkboxes = form.querySelectorAll("input[type=checkbox]");
    const selects = form.querySelectorAll("select");

    checkboxes.forEach(cb => cb.checked = false);
    selects.forEach(select => select.selectedIndex = 0);
  }
};
const radios = document.querySelectorAll("input[type=radio]");
radios.forEach(r => r.checked = false);
</script>
</body>
</html>
